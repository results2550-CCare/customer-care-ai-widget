<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Customer Care AI — WOW Monster + Hands-Free Voice</title>
  <style>
    :root{
      --bg0:#05060a; --bg1:#081022; --bg2:#0b1a3a;
      --glass: rgba(255,255,255,.07); --glass2: rgba(255,255,255,.10);
      --stroke: rgba(255,255,255,.14);
      --txt: rgba(255,255,255,.92); --muted: rgba(255,255,255,.72);
      --accent:#ff8a00; --accent2:#ffd36a; --green:#56ff7a;
      --shadow: 0 30px 90px rgba(0,0,0,.55);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", sans-serif;
      color:var(--txt); overflow-x:hidden;
      background:
        radial-gradient(900px 500px at 30% 15%, rgba(255,138,0,.18), transparent 60%),
        radial-gradient(900px 500px at 70% 20%, rgba(70,140,255,.12), transparent 60%),
        radial-gradient(900px 600px at 50% 90%, rgba(0,255,170,.08), transparent 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1) 45%, var(--bg2));
    }
    .bg-motion{
      position:fixed; inset:-40vh -40vw; pointer-events:none; opacity:.9;
      background:
        radial-gradient(600px 300px at 30% 60%, rgba(255,255,255,.06), transparent 60%),
        radial-gradient(500px 250px at 70% 70%, rgba(255,255,255,.05), transparent 60%),
        radial-gradient(700px 360px at 50% 85%, rgba(255,138,0,.05), transparent 60%);
      filter: blur(20px);
      animation: drift 18s linear infinite;
    }
    @keyframes drift{0%{transform:translate3d(-2%,0,0) rotate(0)}50%{transform:translate3d(2%,-1%,0) rotate(2deg)}100%{transform:translate3d(-2%,0,0) rotate(0)}}

    .wrap{min-height:100%; display:flex; align-items:center; justify-content:center; padding:28px 16px 44px; position:relative; z-index:2;}
    .stage{
      width:min(1040px, 96vw); position:relative;
      border:1px solid rgba(255,255,255,.10);
      border-radius:22px;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .topbar{padding:22px 22px 10px; display:flex; gap:18px; align-items:flex-start; justify-content:space-between;}
    .title h1{margin:0; font-size: clamp(28px, 4vw, 44px); letter-spacing:.2px;}
    .title p{margin:8px 0 0; color:var(--muted); line-height:1.35; max-width:70ch;}
    .pillrow{display:flex; gap:10px; flex-wrap:wrap; margin-top:14px;}
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 12px; border-radius:999px;
      background: rgba(0,0,0,.18);
      border:1px solid rgba(255,255,255,.12);
      color:rgba(255,255,255,.82); font-size:13px; user-select:none;
    }
    .dot{width:9px;height:9px;border-radius:50%; background:var(--accent); box-shadow:0 0 18px rgba(255,138,0,.55);}
    .grid{display:grid; grid-template-columns: 1.08fr .92fr; gap:16px; padding:16px 22px 24px;}
    @media (max-width: 860px){ .grid{grid-template-columns:1fr} }

    .panel{border:1px solid var(--stroke); background: rgba(0,0,0,.18); border-radius:18px; overflow:hidden; position:relative;}
    .panel-hd{
      padding:12px 14px; display:flex; justify-content:space-between; align-items:center;
      border-bottom:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      font-weight:700; letter-spacing:.2px;
    }
    .panel-hd small{font-weight:650; color:rgba(255,255,255,.70);}
    .panel-bd{padding:14px; position:relative; min-height: 390px;}

    .formbox{
      position:relative; border-radius:16px;
      background: rgba(255,255,255,.04);
      border:1px dashed rgba(255,255,255,.22);
      padding:16px; overflow:hidden; transform-origin:center;
    }
    .field{
      height:46px; border-radius:12px;
      background: rgba(0,0,0,.20);
      border:1px solid rgba(255,255,255,.10);
      margin:12px 0; display:flex; align-items:center;
      padding:0 14px; color:rgba(255,255,255,.55); user-select:none;
    }
    .field.big{height:112px; align-items:flex-start; padding-top:12px}
    .btn{
      margin-top:14px; height:54px; border-radius:14px; border:0;
      background: linear-gradient(180deg, var(--accent2), var(--accent));
      color:#1a1206; font-weight:900; font-size:16px; letter-spacing:.3px;
      width:100%; box-shadow:0 12px 32px rgba(255,138,0,.28);
      user-select:none; cursor:pointer;
    }

    .reveal{
      position:absolute; inset:0; z-index:20;
      opacity:0; transform: translateY(14px);
      transition: opacity .65s ease, transform .65s ease;
      pointer-events:none;
    }
    .reveal.on{opacity:1; transform: translateY(0); pointer-events:auto;}
    .cleanCard{
      border-radius:18px; border:1px solid rgba(255,255,255,.14);
      background: rgba(12,18,35,.58);
      box-shadow: 0 22px 60px rgba(0,0,0,.45);
      overflow:hidden;
    }
    .cleanHd{
      padding:12px 14px; display:flex; align-items:center; justify-content:space-between;
      border-bottom:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.05);
      font-weight:900; letter-spacing:.2px;
    }
    .cleanBd{padding:14px; color:rgba(255,255,255,.78); line-height:1.35;}

    .widget{
      margin-top:12px; border-radius:16px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(0,0,0,.22);
      overflow:hidden;
    }
    .widgetTop{
      padding:10px 12px; display:flex; align-items:center; justify-content:space-between;
      border-bottom:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      gap:10px;
    }
    .widgetTitle{display:flex; align-items:center; gap:10px; font-weight:850;}
    .orb{
      width:14px; height:14px; border-radius:999px;
      background: radial-gradient(circle at 30% 30%, #fff, var(--accent) 40%, rgba(255,138,0,.25) 70%);
      box-shadow: 0 0 22px rgba(255,138,0,.35);
    }
    .controls{display:flex; align-items:center; gap:8px;}
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:6px 10px; border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      font-size:12px; color:rgba(255,255,255,.80);
      user-select:none;
    }
    .chip .s{width:8px;height:8px;border-radius:50%; background:rgba(255,255,255,.35);}
    .chip.on .s{background: var(--green); box-shadow:0 0 16px rgba(86,255,122,.55);}
    .iconBtn{
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      color:rgba(255,255,255,.86);
      border-radius:12px;
      height:34px;
      padding:0 10px;
      cursor:pointer;
      font-weight:800;
    }
    .iconBtn:active{transform:translateY(1px)}
    .widgetBody{padding:12px}
    .log{
      height:160px; overflow:auto;
      border:1px solid rgba(255,255,255,.12);
      border-radius:14px;
      background: rgba(0,0,0,.18);
      padding:10px;
      font-size:13px;
      line-height:1.35;
      color:rgba(255,255,255,.82);
    }
    .m{margin:8px 0}
    .me{color:rgba(255,255,255,.92)}
    .ai{color:rgba(255,255,255,.78)}
    .muted{color:rgba(255,255,255,.62)}
    .row{display:flex; gap:10px; margin-top:10px;}
    .inp{
      flex:1;
      height:44px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      color:rgba(255,255,255,.90);
      padding:0 12px;
      outline:none;
      font-weight:650;
    }
    .send{
      height:44px; border-radius:14px; border:0;
      background: linear-gradient(180deg, var(--accent2), var(--accent));
      color:#1a1206; font-weight:950; padding:0 14px; cursor:pointer;
    }

    .autohint{
      position:absolute; left:16px; bottom:12px;
      font-size:12px; color:rgba(255,255,255,.62);
      padding:8px 10px; border-radius:999px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12);
      user-select:none;
      z-index:5;
    }

    .shredLayer{position:absolute; inset:-10%; display:none; z-index:35; pointer-events:none;}
    .shredLayer.active{display:block}
    .strip{
      position:absolute; height:16px; width:140%; left:-20%;
      border-radius:999px;
      background: linear-gradient(90deg, rgba(0,0,0,0), rgba(86,255,122,.95), rgba(255,255,255,.9), rgba(86,255,122,.95), rgba(0,0,0,0));
      filter: blur(.3px); opacity:0;
      transform: rotate(var(--rot)) translateY(var(--y));
      box-shadow:0 0 26px rgba(86,255,122,.45);
    }

    .debris{position:absolute; inset:0; z-index:38; pointer-events:none; display:none;}
    .debris.active{display:block}
    .debris .chip2{
      position:absolute;
      width:14px; height:10px;
      border-radius:3px;
      background: rgba(255,255,255,.78);
      opacity:0;
      filter: blur(.2px);
    }

    .monster{
      position:absolute;
      width:min(520px, 88vw);
      height:min(520px, 88vw);
      left:50%;
      top:66%;
      transform: translate(-50%,-50%) scale(.35);
      opacity:0;
      filter: drop-shadow(0 30px 50px rgba(0,0,0,.65));
      z-index:40;
      pointer-events:none;
    }
    .claws{
      position:absolute;
      width:min(560px, 92vw);
      height:min(560px, 92vw);
      left:50%;
      top:64%;
      transform: translate(-50%,-50%) scale(.35);
      opacity:0;
      z-index:41;
      filter: drop-shadow(0 18px 40px rgba(0,0,0,.55));
      pointer-events:none;
    }
    .bird{
      position:absolute;
      width:120px; height:120px;
      right:-40px; top:44%;
      opacity:0; z-index:45;
      filter: drop-shadow(0 18px 30px rgba(0,0,0,.55));
      transform: rotate(-10deg) scale(.8);
      pointer-events:none;
    }

    @keyframes monsterIn{
      0%{opacity:0; transform: translate(-50%,-50%) scale(.20) rotate(-6deg);}
      25%{opacity:1;}
      55%{transform: translate(-50%,-55%) scale(.85) rotate(2deg);}
      100%{opacity:1; transform: translate(-50%,-52%) scale(.95) rotate(0deg);}
    }
    @keyframes clawsIn{
      0%{opacity:0; transform: translate(-50%,-50%) scale(.15) rotate(10deg);}
      30%{opacity:1;}
      60%{transform: translate(-50%,-52%) scale(.95) rotate(-3deg);}
      100%{opacity:1; transform: translate(-50%,-50%) scale(1.0) rotate(0deg);}
    }
    @keyframes slam{0%{transform:scale(1)}50%{transform:scale(.985) rotate(-.3deg)}100%{transform:scale(1)}}
    @keyframes stripSlash{
      0%{opacity:0; transform: rotate(var(--rot)) translateY(var(--y)) translateX(-40px) scaleX(.8);}
      15%{opacity:1;}
      80%{opacity:1;}
      100%{opacity:0; transform: rotate(var(--rot)) translateY(var(--y)) translateX(240px) scaleX(1.05);}
    }
    @keyframes chipFly{
      0%{opacity:0; transform: translate3d(0,0,0) rotate(0deg) scale(1);}
      10%{opacity:1;}
      100%{opacity:0; transform: translate3d(var(--dx), var(--dy), 0) rotate(var(--dr)) scale(.85);}
    }
    @keyframes formShred{
      0%{filter:none; transform:scale(1) rotate(0); opacity:1;}
      20%{filter:contrast(1.2) saturate(1.1); transform:scale(.995) rotate(-.2deg);}
      55%{transform:scale(.985) rotate(.25deg);}
      100%{transform:scale(.92) rotate(-.6deg); opacity:0; filter:blur(2px);}
    }
    @keyframes birdFly{
      0%{opacity:0; transform: translate3d(0,0,0) rotate(-10deg) scale(.8);}
      10%{opacity:1;}
      100%{opacity:0; transform: translate3d(-540px,-240px,0) rotate(-22deg) scale(.6);}
    }

    @media (prefers-reduced-motion: reduce){
      *{animation:none!important; transition:none!important}
      .reveal{opacity:1; transform:none}
      .autohint{display:none}
    }
  </style>
</head>
<body>
  <div class="bg-motion"></div>

  <div class="wrap">
    <div class="stage" id="stage">
      <div class="topbar">
        <div class="title">
          <h1>Customer Care AI</h1>
          <p>Monster tears the boring form apart → clean voice-first experience appears. Hands-free voice (auto-listen loop after one tap) + speech reply demo.</p>
          <div class="pillrow">
            <span class="pill"><span class="dot"></span> Auto plays after 2 seconds</span>
            <span class="pill"><span class="dot"></span> Cinematic shred / debris</span>
            <span class="pill"><span class="dot"></span> Hands-free voice loop</span>
          </div>
        </div>
      </div>

      <div class="grid">
        <div class="panel">
          <div class="panel-hd">Clean Reveal <small>voice-first</small></div>
          <div class="panel-bd">
            <div class="cleanCard reveal" id="revealLeft" aria-hidden="true">
              <div class="cleanHd">
                Customer Care AI
                <span style="color:rgba(255,255,255,.70);font-weight:800;">Hands-Free Demo</span>
              </div>
              <div class="cleanBd">
                <div>Tap “Enable Voice” once. Then speak normally — it auto-listens and auto-sends.</div>
                <div class="widget" id="widget">
                  <div class="widgetTop">
                    <div class="widgetTitle"><span class="orb"></span> Voice Agent</div>
                    <div class="controls">
                      <div class="chip" id="micState"><span class="s"></span><span id="micLabel">Mic: OFF</span></div>
                      <button class="iconBtn" id="enableVoiceBtn" type="button">Enable Voice</button>
                      <button class="iconBtn" id="muteTtsBtn" type="button">TTS: ON</button>
                    </div>
                  </div>
                  <div class="widgetBody">
                    <div class="log" id="log"></div>
                    <div class="row">
                      <input class="inp" id="textIn" placeholder="Type is optional — speak hands-free after enabling voice…" />
                      <button class="send" id="sendBtn" type="button">Send</button>
                    </div>
                    <div class="muted" style="margin-top:8px;font-size:12px;">
                      Note: mobile browsers require one initial tap to allow mic. After that this runs hands-free in an auto-restart loop.
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="autohint" id="hint">Auto starts in 2 seconds…</div>
          </div>
        </div>

        <div class="panel" id="rightPanel">
          <div class="panel-hd">Old Website Form <small>gets destroyed</small></div>
          <div class="panel-bd" id="panelBody">
            <div class="formbox" id="formBox">
              <div class="field">First name</div>
              <div class="field">Last name</div>
              <div class="field">Email address</div>
              <div class="field">Phone number</div>
              <div class="field big">Message</div>
              <button class="btn" type="button" id="fakeSubmit">Submit</button>
            </div>

            <div class="cleanCard reveal" id="revealRight" aria-hidden="true">
              <div class="cleanHd">
                No Forms. Just Talk.
                <span style="color:rgba(255,255,255,.70);font-weight:800;">Customer Care AI</span>
              </div>
              <div class="cleanBd">
                The friction is gone. Customers speak like a phone call. Faster leads. Higher retention.
                <div class="widget" style="margin-top:12px;">
                  <div class="widgetTop">
                    <div class="widgetTitle"><span class="orb"></span> Industry Demo</div>
                    <div class="controls">
                      <div class="chip"><span class="s" style="background:var(--accent);box-shadow:0 0 16px rgba(255,138,0,.55)"></span> Dental</div>
                      <div class="chip"><span class="s" style="background:rgba(70,140,255,.7);box-shadow:0 0 16px rgba(70,140,255,.35)"></span> Legal</div>
                      <div class="chip"><span class="s" style="background:rgba(255,255,255,.35)"></span> Tyres</div>
                    </div>
                  </div>
                  <div class="widgetBody">
                    <div class="muted">Plug-in widget goes here (voice + inventory + leads + orders).</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="debris" id="debris"></div>

            <div class="shredLayer" id="shredLayer">
              <div class="strip" style="--rot:-12deg; --y:40px;"></div>
              <div class="strip" style="--rot:10deg;  --y:120px;"></div>
              <div class="strip" style="--rot:-8deg;  --y:200px;"></div>
              <div class="strip" style="--rot:16deg;  --y:280px;"></div>
              <div class="strip" style="--rot:-14deg; --y:330px;"></div>
            </div>

            <svg class="monster" id="monster" viewBox="0 0 500 500" aria-hidden="true">
              <defs>
                <linearGradient id="mG" x1="0" x2="1">
                  <stop offset="0" stop-color="#0b0f18"/>
                  <stop offset="0.55" stop-color="#0a0c14"/>
                  <stop offset="1" stop-color="#070912"/>
                </linearGradient>
                <linearGradient id="glow" x1="0" x2="1">
                  <stop offset="0" stop-color="rgba(86,255,122,.0)"/>
                  <stop offset=".5" stop-color="rgba(86,255,122,.55)"/>
                  <stop offset="1" stop-color="rgba(86,255,122,.0)"/>
                </linearGradient>
              </defs>

              <path d="M250 55c75 0 130 40 150 95 26 70-6 162-55 220-42 49-83 75-140 75-57 0-98-26-140-75-49-58-81-150-55-220 20-55 75-95 150-95z"
                    fill="rgba(0,0,0,.20)" stroke="rgba(255,255,255,.10)" stroke-width="6"/>

              <path d="M120 245c10-75 65-140 130-150 68-10 125 32 150 90 18 42 12 92-10 130-20 36-46 60-78 73-44 18-94 16-132-8-41-26-70-70-60-135z"
                    fill="url(#mG)" stroke="rgba(255,255,255,.08)" stroke-width="4"/>

              <path d="M210 115l-34-48 60 20z" fill="#070a12" stroke="rgba(255,255,255,.08)" stroke-width="3"/>
              <path d="M290 115l34-48-60 20z" fill="#070a12" stroke="rgba(255,255,255,.08)" stroke-width="3"/>
              <path d="M160 170l-52-22 46-10z" fill="#070a12" opacity=".95"/>
              <path d="M340 170l52-22-46-10z" fill="#070a12" opacity=".95"/>

              <ellipse cx="205" cy="220" rx="18" ry="10" fill="rgba(86,255,122,.92)"/>
              <ellipse cx="295" cy="220" rx="18" ry="10" fill="rgba(86,255,122,.92)"/>
              <path d="M155 220h190" stroke="url(#glow)" stroke-width="10" opacity=".55"/>

              <path d="M190 290c18 24 42 36 60 36s42-12 60-36" fill="none" stroke="rgba(255,255,255,.22)" stroke-width="8" stroke-linecap="round"/>
              <path d="M210 305l12 30 18-26 10 28 18-26 10 28 18-26 10 28 18-26 12 30"
                    fill="none" stroke="rgba(255,255,255,.26)" stroke-width="6" stroke-linecap="round" stroke-linejoin="round"/>

              <path d="M120 250c-35 20-55 50-65 84 30-18 58-18 85-6" fill="#070a12" opacity=".95"/>
              <path d="M380 250c35 20 55 50 65 84-30-18-58-18-85-6" fill="#070a12" opacity=".95"/>
            </svg>

            <svg class="claws" id="claws" viewBox="0 0 600 600" aria-hidden="true">
              <defs>
                <linearGradient id="cG" x1="0" x2="1">
                  <stop offset="0" stop-color="rgba(86,255,122,.98)"/>
                  <stop offset=".55" stop-color="rgba(255,255,255,.92)"/>
                  <stop offset="1" stop-color="rgba(86,255,122,.98)"/>
                </linearGradient>
              </defs>
              <path d="M120 420c140-140 300-220 420-240" stroke="url(#cG)" stroke-width="18" stroke-linecap="round" opacity=".92"/>
              <path d="M110 350c160-150 320-230 450-250" stroke="url(#cG)" stroke-width="14" stroke-linecap="round" opacity=".75"/>
              <path d="M150 500c120-120 270-200 390-220" stroke="url(#cG)" stroke-width="16" stroke-linecap="round" opacity=".88"/>
              <path d="M190 560c90-90 210-150 320-170" stroke="url(#cG)" stroke-width="12" stroke-linecap="round" opacity=".70"/>
            </svg>

            <svg class="bird" id="bird" viewBox="0 0 120 120" aria-hidden="true">
              <path d="M10 70c20-10 30-30 50-30 10 0 20 10 30 20 10-10 20-20 30-20-12 22-28 40-50 45 8 10 16 18 22 25-20-4-38-14-52-32-8 10-18 18-30 24 6-12 12-22 0-32z"
                    fill="rgba(255,255,255,.92)" />
            </svg>
          </div>
        </div>
      </div>

    </div>
  </div>

  <script>
    // =======================
    // CINEMATIC MONSTER INTRO
    // =======================
    const hint = document.getElementById('hint');
    const fakeSubmit = document.getElementById('fakeSubmit');
    const formBox = document.getElementById('formBox');
    const shredLayer = document.getElementById('shredLayer');
    const strips = [...shredLayer.querySelectorAll('.strip')];
    const debris = document.getElementById('debris');
    const monster = document.getElementById('monster');
    const claws = document.getElementById('claws');
    const bird = document.getElementById('bird');
    const revealLeft = document.getElementById('revealLeft');
    const revealRight = document.getElementById('revealRight');
    const stage = document.getElementById('stage');

    let ran = false;

    function makeDebris(){
      debris.innerHTML = '';
      const count = 30;
      for(let i=0;i<count;i++){
        const d = document.createElement('div');
        d.className = 'chip2';
        d.style.left = (40 + Math.random()*55) + '%';
        d.style.top  = (35 + Math.random()*45) + '%';
        d.style.setProperty('--dx', (Math.random()*420 - 210) + 'px');
        d.style.setProperty('--dy', (Math.random()*-260 - 40) + 'px');
        d.style.setProperty('--dr', (Math.random()*220 - 110) + 'deg');
        debris.appendChild(d);
      }
    }

    function playCinematic(){
      if(ran) return;
      ran = true;
      if(hint) hint.textContent = 'RUNNING…';

      makeDebris();
      debris.classList.add('active');

      stage.style.animation = 'slam .28s ease 2';

      monster.style.animation = 'monsterIn .65s cubic-bezier(.2,.9,.2,1) forwards';
      claws.style.animation  = 'clawsIn  .55s cubic-bezier(.2,.9,.2,1) forwards';
      monster.style.opacity = '1';
      claws.style.opacity = '1';

      setTimeout(() => {
        shredLayer.classList.add('active');

        strips.forEach((s, idx) => {
          s.style.animation = `stripSlash .55s ease ${idx*0.12}s forwards`;
        });

        [...debris.querySelectorAll('.chip2')].forEach((c, i) => {
          c.style.animation = `chipFly .85s cubic-bezier(.15,.8,.2,1) ${i*0.02}s forwards`;
        });

        formBox.style.animation = 'formShred 1.05s ease forwards';
      }, 420);

      setTimeout(() => {
        revealLeft.classList.add('on');
        revealRight.classList.add('on');
        if(hint) hint.textContent = 'REVEALED ✅';
      }, 1500);

      setTimeout(() => {
        bird.style.opacity = '1';
        bird.style.animation = 'birdFly 1.3s ease forwards';
        monster.style.transition = 'opacity .5s ease';
        claws.style.transition = 'opacity .5s ease';
        monster.style.opacity = '0';
        claws.style.opacity = '0';
      }, 1850);

      setTimeout(() => {
        debris.classList.remove('active');
        shredLayer.classList.remove('active');
        if(hint) hint.style.display = 'none';
      }, 3200);
    }

    setTimeout(playCinematic, 2000);
    fakeSubmit.addEventListener('click', () => location.reload());

    // =======================
    // HANDS-FREE VOICE DEMO
    // =======================
    const logEl = document.getElementById('log');
    const textIn = document.getElementById('textIn');
    const sendBtn = document.getElementById('sendBtn');
    const enableVoiceBtn = document.getElementById('enableVoiceBtn');
    const muteTtsBtn = document.getElementById('muteTtsBtn');
    const micState = document.getElementById('micState');
    const micLabel = document.getElementById('micLabel');

    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    let rec = null;
    let autoListenEnabled = false;
    let isStarting = false;
    let ttsEnabled = true;

    function nowTime(){
      const d = new Date();
      return d.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
    }
    function addMsg(kind, text){
      const div = document.createElement('div');
      div.className = 'm ' + (kind === 'me' ? 'me' : 'ai');
      div.innerHTML = `<span class="muted">[${nowTime()}]</span> <b>${kind === 'me' ? 'You' : 'Agent'}:</b> ${escapeHtml(text)}`;
      logEl.appendChild(div);
      logEl.scrollTop = logEl.scrollHeight;
    }
    function escapeHtml(s){
      return (s ?? '').toString()
        .replaceAll('&','&amp;').replaceAll('<','&lt;')
        .replaceAll('>','&gt;').replaceAll('"','&quot;')
        .replaceAll("'","&#039;");
    }

    function setMicUI(on, label){
      micState.classList.toggle('on', !!on);
      micLabel.textContent = label;
    }

    function speak(text){
      if(!ttsEnabled) return;
      if(!('speechSynthesis' in window)) return;
      try{
        window.speechSynthesis.cancel();
        const u = new SpeechSynthesisUtterance(text);
        u.rate = 1.02;
        u.pitch = 1.0;
        u.lang = 'en-AU';
        window.speechSynthesis.speak(u);
      }catch(_){}
    }

    function agentReply(userText){
      const t = userText.trim();
      if(!t) return;
      // Demo reply logic (replace with real OpenAI call later)
      let reply = "I’m here. Tell me what you need and I’ll handle it.";
      const lc = t.toLowerCase();

      if(lc.includes("price") || lc.includes("quote")) reply = "Got it. What product or service are we quoting, and what location?";
      else if(lc.includes("book") || lc.includes("appointment")) reply = "Okay. What day and time do you want, and what’s your name?";
      else if(lc.includes("inventory")) reply = "Understood. Point me to the inventory source (POS/CSV/Shopify) and I’ll map it.";
      else if(lc.includes("help") || lc.includes("support")) reply = "I can help. What’s the issue in one sentence?";
      else if(lc.includes("hello") || lc.includes("hi")) reply = "Hello. Want voice-only, or voice + text?";

      addMsg('ai', reply);
      speak(reply);
    }

    function sendMessage(text){
      const t = (text ?? '').trim();
      if(!t) return;
      addMsg('me', t);
      textIn.value = '';
      agentReply(t);
    }

    sendBtn.addEventListener('click', () => sendMessage(textIn.value));
    textIn.addEventListener('keydown', (e) => {
      if(e.key === 'Enter') sendMessage(textIn.value);
    });

    muteTtsBtn.addEventListener('click', () => {
      ttsEnabled = !ttsEnabled;
      muteTtsBtn.textContent = ttsEnabled ? 'TTS: ON' : 'TTS: OFF';
      try{ window.speechSynthesis.cancel(); }catch(_){}
    });

    function safeStartRec(){
      if(!rec || isStarting) return;
      try{
        isStarting = true;
        rec.start();
        setMicUI(true, 'Mic: LISTENING');
      }catch(_){
        // start can throw when already started
      }finally{
        setTimeout(() => (isStarting = false), 350);
      }
    }

    function enableAutoListenOnce(){
      if(!SpeechRecognition){
        addMsg('ai', 'Speech recognition not supported in this browser.');
        speak('Speech recognition is not supported in this browser.');
        return;
      }
      if(autoListenEnabled){
        // already enabled: just nudge restart
        safeStartRec();
        return;
      }

      autoListenEnabled = true;

      rec = new SpeechRecognition();
      rec.lang = 'en-AU';
      rec.continuous = true;
      rec.interimResults = true;

      let finalBuffer = '';
      let lastFinalAt = 0;

      rec.onresult = (event) => {
        let interim = '';
        for(let i = event.resultIndex; i < event.results.length; i++){
          const chunk = event.results[i][0].transcript || '';
          if(event.results[i].isFinal) finalBuffer += chunk;
          else interim += chunk;
        }

        // When we get final text, send it.
        const finalText = finalBuffer.trim();
        const now = Date.now();
        if(finalText && (now - lastFinalAt) > 550){
          lastFinalAt = now;
          finalBuffer = '';
          sendMessage(finalText);
        }

        // UI hint if you want it
        if(interim.trim()){
          setMicUI(true, 'Mic: HEARING…');
        }else{
          setMicUI(true, 'Mic: LISTENING');
        }
      };

      rec.onerror = (e) => {
        const err = (e && e.error) ? e.error : 'unknown';
        if(err === 'not-allowed' || err === 'service-not-allowed'){
          autoListenEnabled = false;
          setMicUI(false, 'Mic: BLOCKED');
          addMsg('ai', 'Microphone permission is blocked. Enable mic permission for this site.');
          speak('Microphone permission is blocked. Enable microphone permission for this site.');
          return;
        }
        // common: no-speech, aborted, audio-capture
        setMicUI(true, 'Mic: RETRYING');
      };

      rec.onend = () => {
        if(!autoListenEnabled) return;
        setMicUI(true, 'Mic: RESTARTING');
        setTimeout(safeStartRec, 250);
      };

      // Must be triggered by user tap on mobile
      safeStartRec();

      // One-time greeting (does not loop)
      setTimeout(() => {
        addMsg('ai', 'Voice is enabled. Speak naturally — I’ll auto-listen and reply.');
        speak('Voice is enabled. Speak naturally. I will listen hands free and reply.');
      }, 120);
    }

    enableVoiceBtn.addEventListener('click', enableAutoListenOnce);

    // Initial log content
    addMsg('ai', 'Tap “Enable Voice” once, then speak hands-free. This is the demo shell; real OpenAI backend gets wired in next.');
    setMicUI(false, 'Mic: OFF');
  </script>
</body>
</html>
```0
